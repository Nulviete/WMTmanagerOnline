import{r as s,H as q,_ as $,G as E,J as y,a7 as g,M as t,L as D,O as n,Y as N,aC as Y,aD as j,K as F,a8 as Q,a4 as J}from"./index.181651b6.js";import{Q as L}from"./QPage.fffa2538.js";import{Q as C,a as P}from"./QForm.8fc05feb.js";import{Q as f}from"./QSelect.92bfe2dd.js";import{Q as w}from"./QCheckbox.708760d2.js";import{u as z}from"./use-quasar.e573c060.js";import"./use-key-composition.19db8c27.js";import"./uid.42677368.js";import"./scroll.76abc915.js";const B=()=>{const i=s(null),a=s(!1),v=s(null);return{loadMember:async r=>{try{const{data:u}=await q.from("members").select("*").eq("id",r);u&&(i.value=u[0],a.value=!0)}catch(u){v.value=u.message}},updateMember:async(r,u,m,c,b,p,d)=>{const{data:_,error:M}=await q.from("members").update({name:u,country:m,position:c,positionDescription:b,dateSince:p,dateTill:d}).eq("id",r).select();M&&(v.value=M),_&&(i.value=_)},data:i,dataLoaded:a,errorMess:v}};const h=i=>(Y("data-v-3c56ee50"),i=i(),j(),i),H={key:0},R={key:1},A=h(()=>n("h5",{class:"text-center"},"Memba modifajar",-1)),G={class:"row q-gutter-sm justify-center"},K={class:"leftBlock"},W={class:"row items-center"},X=h(()=>n("div",{class:"h3-text"},"Start of cooperation",-1)),Z={class:"row q-gutter-xs"},ee={class:"rightBlock"},le={class:"row items-center"},oe=h(()=>n("div",{class:"h3-text"},"End of cooperation",-1)),ae=h(()=>n("div",{class:"h3-text"},"Currently working",-1)),te={class:"row q-gutter-xs"},se={class:"row justify-center"},ue={__name:"ModifyMemberTable",props:{member:{type:Object,default:null}},setup(i){const a=i;console.log(a);const v=z(),V=E(),l=s({name:a.member.name,country:a.member.country,position:a.member.position,positionDescription:a.member.positionDescription,dateSince:a.member.dateSince,dateTill:a.member.dateTill}),r=s(""),u=s("");l.value.dateSince&&(r.value=a.member.dateSince.substr(0,3),u.value=a.member.dateSince.substr(4,7));const m=s(a.member.dateTill==="now"),c=s(""),b=s(""),p=s(!1),d=s(!1);a.member.dateTill!=="now"&&(d.value=!0,c.value=a.member.dateTill.substr(0,3),b.value=a.member.dateTill.substr(4,7));const _=s([{label:"Poland",value:"pl"},{label:"Ukraine",value:"ua"},{label:"Czech republic",value:"cz"},{label:"Spain",value:"sp"},{label:"Italy",value:"it"},{label:"Morocco",value:"mo"}]),M=s([{label:"Root Member"},{label:"Volunteer"}]),x=new Date().getFullYear(),T=["Jan","Feb","Mar","Apr","May","Jun","Jul","Sep","Oct","Nov","Dec"],k=s([]);for(let S=x-5;S<x+5;S++)k.value.push(S);const{updateMember:O,errorMess:U}=B();async function I(){l.value.country=l.value.country.value,p.value&&(l.value.dateSince=r.value+" of "+u.value),d.value&&(l.value.dateTill=c.value+" of "+b.value),m.value&&(l.value.dateTill="now"),O(a.member.id,l.value.name,l.value.country,l.value.position,l.value.position,l.value.positionDescription,l.value.dateSince,l.value.dateTill),U.value?alert(U.value):(v.notify("Member has been successfully modified"),setTimeout(()=>V.push({path:"/Members"}),1500))}return(S,e)=>a.member.position==="Head of the Foundation"||a.member.position==="Vice"?(y(),g("div",H,"Not elligible to modify head members of foundation")):(y(),g("div",R,[t(P,{style:{},class:"q-mx-auto q-pa-md",onSubmit:I},{default:D(()=>[A,t(C,{modelValue:l.value.name,"onUpdate:modelValue":e[0]||(e[0]=o=>l.value.name=o),label:"Name",required:""},null,8,["modelValue"]),t(f,{modelValue:l.value.country,"onUpdate:modelValue":e[1]||(e[1]=o=>l.value.country=o),options:_.value,label:"Country",required:""},null,8,["modelValue","options"]),t(f,{modelValue:l.value.position,"onUpdate:modelValue":e[2]||(e[2]=o=>l.value.position=o),options:M.value,label:"Position",required:""},null,8,["modelValue","options"]),t(C,{modelValue:l.value.positionDescription,"onUpdate:modelValue":e[3]||(e[3]=o=>l.value.positionDescription=o),label:"Description of position"},null,8,["modelValue"]),n("div",G,[n("div",K,[n("div",W,[t(w,{modelValue:p.value,"onUpdate:modelValue":e[4]||(e[4]=o=>p.value=o)},null,8,["modelValue"]),X]),n("div",Z,[t(f,{filled:"",modelValue:r.value,"onUpdate:modelValue":e[5]||(e[5]=o=>r.value=o),options:T,label:"Month",disable:!p.value},null,8,["modelValue","disable"]),t(f,{filled:"",modelValue:u.value,"onUpdate:modelValue":e[6]||(e[6]=o=>u.value=o),options:k.value,label:"Year",disable:!p.value},null,8,["modelValue","options","disable"])])]),n("div",ee,[n("div",le,[t(w,{modelValue:d.value,"onUpdate:modelValue":e[7]||(e[7]=o=>d.value=o),onClick:e[8]||(e[8]=o=>m.value=!d.value)},null,8,["modelValue"]),oe,t(w,{modelValue:m.value,"onUpdate:modelValue":e[9]||(e[9]=o=>m.value=o),onClick:e[10]||(e[10]=o=>d.value=!m.value)},null,8,["modelValue"]),ae]),n("div",te,[t(f,{filled:"",modelValue:c.value,"onUpdate:modelValue":e[11]||(e[11]=o=>c.value=o),options:T,label:"Month",class:"",disable:!d.value},null,8,["modelValue","disable"]),t(f,{filled:"",modelValue:b.value,"onUpdate:modelValue":e[12]||(e[12]=o=>b.value=o),options:k.value,label:"Year",class:"",disable:!d.value},null,8,["modelValue","options","disable"])])])]),n("div",se,[t(N,{label:"Update Membo",class:"q-mt-md bg-green-3",type:"submit"})])]),_:1})]))}};var ne=$(ue,[["__scopeId","data-v-3c56ee50"]]);const ie={key:0},re={key:1},Me={__name:"ModifyMember",props:{id:String},setup(i){const a=i,{loadMember:v,data:V,dataLoaded:l,errorMess:r}=B();return v(a.id),r.value&&console.log(r.value),(u,m)=>(y(),F(L,{padding:""},{default:D(()=>[Q(l)?(y(),g("div",ie,[t(ne,{member:Q(V)},null,8,["member"])])):(y(),g("div",re,[t(J)]))]),_:1}))}};export{Me as default};
