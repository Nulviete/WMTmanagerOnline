import{r as d,H as D,a as p,c as A,n as G,o as J,h as m,a6 as K,b as W,a5 as I,_ as Y,G as Z,J as h,K as L,L as b,M as u,P as _,aA as U,Q as $,aB as Q,S as q,aF as X,aG as ee,Z as T,aC as te,aD as oe,a8 as B}from"./index.54b6f0d8.js";import{Q as le}from"./QPage.1b4ea7c2.js";import{Q as y,a as ae}from"./QForm.5e2e73ec.js";import{Q as x}from"./QSelect.d3342a9a.js";import{u as ne}from"./use-quasar.77fa20f4.js";import"./use-key-composition.5f80a910.js";import"./uid.42677368.js";import"./scroll.29190ff5.js";const re=()=>{const e=d(null),r=d(!1),s=d(null);return{loadProject:async t=>{try{const{data:n}=await D.from("projects").select("*").eq("name",t);s.value&&console.log(s),n&&(e.value=n[0],r.value=!0)}catch(n){s.value=n.message}},data:e,dataLoaded:r,error:s}},ie={ratio:[String,Number]};function se(e,r){return p(()=>{const s=Number(e.ratio||(r!==void 0?r.value:void 0));return isNaN(s)!==!0&&s>0?{paddingBottom:`${100/s}%`}:null})}const ue=16/9;var z=A({name:"QImg",props:{...ie,src:String,srcset:String,sizes:String,alt:String,crossorigin:String,decoding:String,referrerpolicy:String,draggable:Boolean,loading:{type:String,default:"lazy"},fetchpriority:{type:String,default:"auto"},width:String,height:String,initialRatio:{type:[Number,String],default:ue},placeholderSrc:String,fit:{type:String,default:"cover"},position:{type:String,default:"50% 50%"},imgClass:String,imgStyle:Object,noSpinner:Boolean,noNativeMenu:Boolean,noTransition:Boolean,spinnerColor:String,spinnerSize:String},emits:["load","error"],setup(e,{slots:r,emit:s}){const v=d(e.initialRatio),t=se(e,v);let n=null,g=!1;const i=[d(null),d(V())],o=d(0),a=d(!1),c=d(!1),f=p(()=>`q-img q-img--${e.noNativeMenu===!0?"no-":""}menu`),M=p(()=>({width:e.width,height:e.height})),N=p(()=>`q-img__image ${e.imgClass!==void 0?e.imgClass+" ":""}q-img__image--with${e.noTransition===!0?"out":""}-transition`),R=p(()=>({...e.imgStyle,objectFit:e.fit,objectPosition:e.position}));G(()=>k(),w);function k(){return e.src||e.srcset||e.sizes?{src:e.src,srcset:e.srcset,sizes:e.sizes}:null}function V(){return e.placeholderSrc!==void 0?{src:e.placeholderSrc}:null}function w(l){n!==null&&(clearTimeout(n),n=null),c.value=!1,l===null?(a.value=!1,i[o.value^1].value=V()):a.value=!0,i[o.value].value=l}function E({target:l}){g!==!0&&(n!==null&&(clearTimeout(n),n=null),v.value=l.naturalHeight===0?.5:l.naturalWidth/l.naturalHeight,C(l,1))}function C(l,S){g===!0||S===1e3||(l.complete===!0?F(l):n=setTimeout(()=>{n=null,C(l,S+1)},50))}function F(l){g!==!0&&(o.value=o.value^1,i[o.value].value=null,a.value=!1,c.value=!1,s("load",l.currentSrc||l.src))}function O(l){n!==null&&(clearTimeout(n),n=null),a.value=!1,c.value=!0,i[o.value].value=null,i[o.value^1].value=V(),s("error",l)}function P(l){const S=i[l].value,j={key:"img_"+l,class:N.value,style:R.value,crossorigin:e.crossorigin,decoding:e.decoding,referrerpolicy:e.referrerpolicy,height:e.height,width:e.width,loading:e.loading,fetchpriority:e.fetchpriority,"aria-hidden":"true",draggable:e.draggable,...S};return o.value===l?(j.class+=" q-img__image--waiting",Object.assign(j,{onLoad:E,onError:O})):j.class+=" q-img__image--loaded",m("div",{class:"q-img__container absolute-full",key:"img"+l},m("img",j))}function H(){return a.value!==!0?m("div",{key:"content",class:"q-img__content absolute-full q-anchor--skip"},W(r[c.value===!0?"error":"default"])):m("div",{key:"loading",class:"q-img__loading absolute-full flex flex-center"},r.loading!==void 0?r.loading():e.noSpinner===!0?void 0:[m(I,{color:e.spinnerColor,size:e.spinnerSize})])}return w(k()),J(()=>{g=!0,n!==null&&(clearTimeout(n),n=null)}),()=>{const l=[];return t.value!==null&&l.push(m("div",{key:"filler",style:t.value})),c.value!==!0&&(i[0].value!==null&&l.push(P(0)),i[1].value!==null&&l.push(P(1))),l.push(m(K,{name:"q-transition--fade"},H)),m("div",{class:f.value,style:M.value,role:"img","aria-label":e.alt},l)}}});const ce=e=>(te("data-v-7aac015f"),e=e(),oe(),e),de={class:"row q-py-xs"},me=ce(()=>_("div",{class:"h5-text q-pt-md"},"Photos:",-1)),ve={class:"row justify-start"},ge={class:"row justify-center"},fe={__name:"ModifyProjectTable",props:{project:Object},setup(e){const r=e,s=Z(),v=ne(),t=d({name:r.project.name,category:r.project.category,year:r.project.year,projectDescription:r.project.projectDescription,photoUrl:r.project.photoUrl,countries:r.project.countries,photos:r.project.photos});t.value.photos||(t.value.photos=[]);const n=p(()=>t.value.photos.filter((i,o)=>t.value.photos.indexOf(i)===o));async function g(){t.value.photos=t.value.photos.filter(a=>a.length>0),t.value.photos=n.value;const{data:i,error:o}=await D.from("projects").update({name:t.value.name,category:t.value.category,year:t.value.year,projectDescription:t.value.projectDescription,photoUrl:t.value.photoUrl,countries:t.value.countries,photos:t.value.photos}).eq("name",r.project.name).select();o&&console.log(o),i&&console.log(i),v.notify("Project has been successfully modified"),setTimeout(()=>s.push({path:"/Projects"}),1500)}return(i,o)=>(h(),L(ae,{style:{width:"600px"},class:"q-pa-md q-mx-auto"},{default:b(()=>[u(y,{label:"Project name",modelValue:t.value.name,"onUpdate:modelValue":o[0]||(o[0]=a=>t.value.name=a)},null,8,["modelValue"]),u(x,{label:"Category",modelValue:t.value.category,"onUpdate:modelValue":o[1]||(o[1]=a=>t.value.category=a)},null,8,["modelValue"]),u(x,{label:"Year",modelValue:t.value.year,"onUpdate:modelValue":o[2]||(o[2]=a=>t.value.year=a)},null,8,["modelValue"]),u(y,{label:"Description of project",modelValue:t.value.projectDescription,"onUpdate:modelValue":o[3]||(o[3]=a=>t.value.projectDescription=a),type:"textarea"},null,8,["modelValue"]),_("div",de,[u(y,{label:"Main photo URL",modelValue:t.value.photoUrl,"onUpdate:modelValue":o[5]||(o[5]=a=>t.value.photoUrl=a),class:"col-10 q-pr-sm",filled:""},U({_:2},[t.value.photoUrl?{name:"append",fn:b(()=>[u($,{name:"cancel",onClick:o[4]||(o[4]=Q(a=>t.value.photoUrl="",["stop","prevent"])),class:"cursor-pointer"})]),key:"0"}:void 0]),1032,["modelValue"]),u(z,{src:t.value.photoUrl,ratio:16/9,width:"80px",class:"q-ml-sm",loading:"lazy",onLoad:o[6]||(o[6]=a=>console.log("loading")),onError:o[7]||(o[7]=a=>console.log("cannot load"))},null,8,["src"])]),u(y,{label:"Participants' countries",modelValue:t.value.countries,"onUpdate:modelValue":o[8]||(o[8]=a=>t.value.countries=a)},null,8,["modelValue"]),me,(h(!0),q(X,null,ee(t.value.photos,(a,c)=>(h(),q("div",{key:c,class:"row q-py-xs"},[u(y,{label:"Photo "+(c+1),modelValue:t.value.photos[c],"onUpdate:modelValue":f=>t.value.photos[c]=f,class:"col-10 q-pr-sm",filled:""},U({_:2},[t.value.photos[c]?{name:"append",fn:b(()=>[u($,{name:"cancel",onClick:Q(f=>t.value.photos[c]="",["stop","prevent"]),class:"cursor-pointer"},null,8,["onClick"])]),key:"0"}:void 0]),1032,["label","modelValue","onUpdate:modelValue"]),u(z,{src:a,ratio:16/9,width:"80px",class:"q-ml-sm",loading:"lazy",onLoad:o[9]||(o[9]=f=>console.log("loading")),onError:o[10]||(o[10]=f=>console.log(i.error))},null,8,["src"])]))),128)),_("div",ve,[u(T,{label:"Add Photo",onClick:o[11]||(o[11]=a=>t.value.photos.length++),class:"q-mt-md bg-blue-2 text-black"})]),_("div",ge,[u(T,{label:"Confirm Changes",onClick:g,class:"q-mt-md bg-green-2 text-black"})])]),_:1}))}};var pe=Y(fe,[["__scopeId","data-v-7aac015f"]]);const he={key:0},ye={key:1},Ce={__name:"ModifyProject",props:{name:String},setup(e){const r=e,{loadProject:s,data:v,dataLoaded:t,error:n}=re();return s(r.name),n&&console.log(n),(g,i)=>(h(),L(le,{padding:""},{default:b(()=>[B(t)?(h(),q("div",he,[u(pe,{project:B(v)},null,8,["project"])])):(h(),q("div",ye,[u(I)]))]),_:1}))}};export{Ce as default};
